<!DOCTYPE html>
<html>
 <head>
 <base target="_top">
 <style>
 body {
 font-family: Arial, sans-serif;
 font-size: 13px;
 padding: 10px;
 }
 select, button {
 margin-top: 8px;
 width: 100%;
 font-size: 13px;
 }
 </style>
 </head>
 <body>
 <label for="config">Select Audit Config:</label>
 <select id="config">
 <? for (let config of auditConfigs) { ?>
 <option value="<?= config.name ?>"><?= config.name ?></option>
 <? } ?>
 </select>
 <button onclick="submitConfig()">Run Audit</button>
 <div id="status" style="margin-top:12px; font-size:12px; color:#555;"></div>
 <script>
 function submitConfig() {
 const config = document.getElementById('config').value;
 const statusEl = document.getElementById('status');
 statusEl.textContent = ` Running audit for "${config}"...`;

 google.script.run
 .withSuccessHandler(() => {
	statusEl.textContent = `✅ Audit for "${config}" completed.`;
 setTimeout(() => google.script.host.close(), 2000);
 })
 .withFailureHandler(error => {
	statusEl.textContent = `❌ Audit failed: ${error.message}`;
 })
 .runDailyAuditByName(config);
 }
 </script>
 </body>
</html>
